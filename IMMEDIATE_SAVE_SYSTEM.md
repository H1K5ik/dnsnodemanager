# üöÄ –°–∏—Å—Ç–µ–º–∞ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è DNS –∑–æ–Ω

## üìã –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –±—ã–ª–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–≥–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è DNS –∑–æ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ã –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ñ–ª–∞–≥–∞ `update_required`. –¢–µ–ø–µ—Ä—å –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É –Ω–∞ DNS —Å–µ—Ä–≤–µ—Ä—ã –≤ –≥–æ—Ç–æ–≤–æ–º –≤–∏–¥–µ.

## üîÑ –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### ‚ùå –°—Ç–∞—Ä–∞—è —Å–∏—Å—Ç–µ–º–∞:
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã—Ä–µ–∑–æ–∫ –∏–∑ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- –§–ª–∞–≥ `update_required` –¥–ª—è –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –û—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ

### ‚úÖ –ù–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:
- **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** –≥–æ—Ç–æ–≤—ã—Ö bind –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –Ω–∞ DNS —Å–µ—Ä–≤–µ—Ä—ã
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** –≤ –ø–∞–ø–∫–∞—Ö `zones/authority` –∏ `zones/forward`
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** bind –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞** DNS —Å–µ—Ä–≤–µ—Ä–∞
- **Git –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

```
/var/named/chroot/var/named/          # config_path —Å–µ—Ä–≤–µ—Ä–∞
‚îú‚îÄ‚îÄ zones/
‚îÇ   ‚îú‚îÄ‚îÄ authority/                    # –ê–≤—Ç–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∑–æ–Ω—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ example.com.zone
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ test.com.zone
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ forward/                      # Forward –∑–æ–Ω—ã
‚îÇ       ‚îú‚îÄ‚îÄ google.com.zone
‚îÇ       ‚îú‚îÄ‚îÄ cloudflare.com.zone
‚îÇ       ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ managedconfig.conf                # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è bind
‚îî‚îÄ‚îÄ ...
```

## üõ†Ô∏è –ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã

### ManagedServer.saveZoneToServer()
```javascript
await managedServer.saveZoneToServer(zoneData, records, userInfo);
```
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–æ–Ω—É —Å—Ä–∞–∑—É –Ω–∞ DNS —Å–µ—Ä–≤–µ—Ä
- –°–æ–∑–¥–∞–µ—Ç –≥–æ—Ç–æ–≤—ã–π bind —Ñ–∞–π–ª –∑–æ–Ω—ã
- –û–±–Ω–æ–≤–ª—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é bind
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç DNS —Å–µ—Ä–≤–µ—Ä

### ManagedServer.buildForwardZoneConfig()
```javascript
const config = managedServer.buildForwardZoneConfig(zoneData);
```
- –°–æ–∑–¥–∞–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –¥–ª—è forward –∑–æ–Ω—ã
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç forwarders

### ManagedServer.updateBindConfig()
```javascript
await managedServer.updateBindConfig(ssh, zoneData);
```
- –û–±–Ω–æ–≤–ª—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é bind
- –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–µ –∑–æ–Ω—ã –≤ managedconfig.conf

## üîß –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–æ–Ω—ã
```javascript
// ZoneProvider.add()
- –°–æ–∑–¥–∞–µ—Ç –∑–æ–Ω—É –≤ –ë–î
- –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∑–æ–Ω—É —Å—Ä–∞–∑—É –Ω–∞ –≤—Å–µ —Å–µ—Ä–≤–µ—Ä—ã –≤ –≥—Ä—É–ø–ø–µ
- –°–æ–∑–¥–∞–µ—Ç Git –∫–æ–º–º–∏—Ç
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
```javascript
// ZoneProvider.addRecord()
- –î–æ–±–∞–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ –ë–î
- –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–æ–Ω—É –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç DNS —Å–µ—Ä–≤–µ—Ä—ã
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
```javascript
// ZoneProvider.updateRecord()
- –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–∞–ø–∏—Å—å –≤ –ë–î
- –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–æ–Ω—É –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç DNS —Å–µ—Ä–≤–µ—Ä—ã
```

### 4. –£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
```javascript
// ZoneProvider.deleteRecords()
- –£–¥–∞–ª—è–µ—Ç –∑–∞–ø–∏—Å–∏ –∏–∑ –ë–î
- –û–±–Ω–æ–≤–ª—è–µ—Ç –∑–æ–Ω—É –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
- –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç DNS —Å–µ—Ä–≤–µ—Ä—ã
```

## üìä Git –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ

–í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç Git –∫–æ–º–º–∏—Ç—ã:

```bash
# –ü—Ä–∏–º–µ—Ä—ã –∫–æ–º–º–∏—Ç–æ–≤
Zone Saved to Server: server1: example.com (authority) (by admin)
Zone Saved to Server: server2: google.com (forward) (by user1)
Record Added: server1: example.com (by admin)
Record Updated: server2: test.com (by user1)
```

## üîÑ –ü—Ä–æ—Ü–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

1. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤ –ë–î** ‚Üí –ó–∞–ø–∏—Å—å/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–æ–≤** ‚Üí –ò–∑ NS –≥—Ä—É–ø–ø—ã –∑–æ–Ω—ã
3. **–°–æ–∑–¥–∞–Ω–∏–µ ManagedServer** ‚Üí –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
4. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è bind —Ñ–∞–π–ª–∞** ‚Üí –ì–æ—Ç–æ–≤—ã–π zone —Ñ–∞–π–ª
5. **–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä** ‚Üí –ß–µ—Ä–µ–∑ SSH –≤ –ø–∞–ø–∫—É zones/
6. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–∞** ‚Üí –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ managedconfig.conf
7. **–ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ DNS** ‚Üí –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è reload
8. **Git –∫–æ–º–º–∏—Ç** ‚Üí –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üö® –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

```javascript
try {
  await managedServer.saveZoneToServer(zoneData, records, userInfo);
  console.log(`Zone ${zoneData.fqdn} saved to server ${server.name}`);
} catch (error) {
  console.error(`Error saving zone to server ${server.name}:`, error);
  // –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏
}
```

## üìà –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ** –∏–∑–º–µ–Ω–µ–Ω–∏–π
- **–ù–µ—Ç –∑–∞–¥–µ—Ä–∂–µ–∫** –Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
- **–ü—Ä—è–º–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** –≥–æ—Ç–æ–≤—ã—Ö –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

### üîí –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞** DNS —Å–µ—Ä–≤–µ—Ä–∞
- **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- **Git –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ** –≤—Å–µ—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

### üéØ –£–¥–æ–±—Å—Ç–≤–æ
- **–ï–¥–∏–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
- **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** –∑–æ–Ω
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è–º–∏

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤

–î–ª—è —Ä–∞–±–æ—Ç—ã –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã DNS —Å–µ—Ä–≤–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å:

1. **SSH –¥–æ—Å—Ç—É–ø** —Å –∫–ª—é—á–∞–º–∏
2. **–ü–∞–ø–∫–∏ zones/** —Å –ø—Ä–∞–≤–∞–º–∏ –∑–∞–ø–∏—Å–∏
3. **Bind —Å–µ—Ä–≤–µ—Ä** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π reload
4. **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª** managedconfig.conf

## üìù –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –∑–æ–Ω—ã
```javascript
const zoneData = {
  fqdn: 'example.com',
  type: 'authoritative',
  ns_group: 1,
  view: 'default',
  comment: 'New zone'
};

// –ó–æ–Ω–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—Å—è –Ω–∞ –≤—Å–µ —Å–µ—Ä–≤–µ—Ä—ã –≤ –≥—Ä—É–ø–ø–µ
await zoneProvider.add(zoneData);
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–∏
```javascript
const recordData = {
  zone_id: 1,
  name: 'www',
  type: 'A',
  data: '192.168.1.100',
  ttl: 3600
};

// –ó–∞–ø–∏—Å—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è –Ω–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö
await zoneProvider.addRecord(recordData);
```

## üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

1. ‚úÖ **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É
2. ‚úÖ **–ì–æ—Ç–æ–≤—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏** - —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è bind —Ñ–∞–π–ª—ã, –∞ –Ω–µ JSON
3. ‚úÖ **–°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ** - –≤ –ø–∞–ø–∫–∞—Ö authority/forward
4. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ** - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥–æ–≤ –∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞
5. ‚úÖ **Git –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –≤–µ—Ä—Å–∏–æ–Ω–Ω–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–µ
6. ‚úÖ **–ë–µ–∑ —Ñ–ª–∞–≥–∞ update_required** - —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ
